---
title: "The Indicators That Affect Teen Pregnancy"
subtitle: "and future implications"
author: "Team-No-Name-Yet <br> Isabel Siebrecht, Franklin Feng, & Kaylin Hernandez"
institute: "Duke University"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
# Remove any packages from this list that you're not using
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)

knitr::opts_chunk$set(eval = TRUE, echo = FALSE, message = FALSE, warning = FALSE)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618, 
  out.width = "70%"
  )
```

```{r load-data, include=FALSE}
hdi1 <- read.csv("../data/HDI_Table1.csv")
hdi4 <- read.csv("../data/HDI_Table4.csv")
hdi5 <- read.csv("../data/HDI_Table5.csv")
hdi8 <- read.csv("../data/HDI_Table8.csv")
hdi10 <- read.csv("../data/HDI_Table10.csv")
adolescent_births <- read.csv("../data/Adolescent_Births.csv")
contraceptive_prevalence <- read.csv("../data/Contraceptive_Prevalence.csv")
```

```{r clean-data, echo=FALSE, message=FALSE, warning=FALSE}
hdi1_clean <- slice(hdi1, -c(1:7, 74, 128, 166, 200, 207:270))
hdi1_clean <- select(hdi1_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11))
names(hdi1_clean) <- c("HDI Rank", "Country", "HDI 2019", "Life Expectancy Birth", "Expected Years Schooling", "Mean Years Schooling", "GNI Per Capita", "GNI Per Capita Minus HDI", "HDI 2018")

hdi4_clean <- slice(hdi4, -c(1:7, 74, 128, 166, 200, 207:264))
hdi4_clean <- select(hdi4_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17, X.19, X.21, X.23))
names(hdi4_clean) <- c("HDI Rank", "Country", "Gender Development Index", "Gender Development Index Group", "HDI Female", "HDI Male", "Life Expectancy Birth Female", "Life Expectancy Birth Male", "Expected Years Schooling Female", "Expected Years Schooling Male", "Mean Years Schooling Female", "Mean Years Schooling Male", "Estimated GNI per Capita Female", "Estimated GNI per Capita Male")

hdi5_clean <- slice(hdi5, -c(1:7, 74, 128, 166, 200, 207:270))
hdi5_clean <- select(hdi5_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17))
names(hdi5_clean) <- c("HDI Rank", "Country", "Gender Inequality Index", "Gender Inequality Index Rank", "Maternal Mortality Ratio", "Adolescent Birth Rate", "Seats Parliament Female", "Secondary Education Female", "Secondary Education Male", "Labour Participation Female", "Labour Participation Male")

hdi8_clean <- slice(hdi8, -c(1:7, 74, 128, 166, 200, 207:264))
hdi8_clean <- select(hdi8_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17, X.19, X.21, X.23, X.25, X.27, X.29 : X.33))
names(hdi8_clean) <- c("HDI Rank", "Country", "Infants Breastfed", "Lack DTP Immunization", "Lack Measles Immunization", "Child Malnutrition", "Mortality Rate Infant", "Mortality Rate Under 5", "Mortality Rate Female", "Mortality Rate Male", "Mortality Rate Noncommunicable Female", "Mortality Rate Noncommunicable Male", "Malaria Incidence", "TB Incidence", "HIV Prevalence", "Healthy Life Expectancy at Birth", "Health Expenditure of GDP")

hdi10_clean <- slice(hdi10, -c(1:7, 74, 128, 166, 200, 207:260))
hdi10_clean <- select(hdi10_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17, X.19, X.21, X.23))
names(hdi10_clean) <- c("HDI Rank", "Country", "GDP", "GDP per Capita", "GDP Annual Growth", "Labour Share", "Gross Fixed Capital Formation of GDP", "General Government Consumption of GDP", "General Government Consumption Annual Growth", "Total Tax Revenue of GDP", "Taxes Income Profits Capital Gains of TTR", "External Debt Stock of GNI", "Total Debt Service of GNI", "Consumer Price Index")

adolescent_births_clean <- select(adolescent_births, select = c(ParentLocation, Location, Period, IsLatestYear, FactValueNumeric, Value))
names(adolescent_births_clean) <- c("World Region", "Country", "Period", "Is Latest Year", "Adolescent Births", "Adolescent Births Text")

contraceptive_prevalence_clean <- slice(contraceptive_prevalence, -c(1:8))
contraceptive_prevalence_clean <- select(contraceptive_prevalence_clean, select = c(X, X.2, X.3, X.4, X.5, X.6, X.19))
names(contraceptive_prevalence_clean) <- c("Country", "Survey Start Year", "Survey End Year", "Age Group", "Contraceptive Any Method", "Contraceptive Modern Method", "Contraceptive Traditional Method")
```

```{r join-datasets, echo=FALSE, message=FALSE, warning=FALSE}

country_joined <- hdi1_clean %>%
  inner_join(hdi10_clean, by = "Country")%>%
  inner_join(hdi4_clean, by = "Country")%>%
  inner_join(hdi5_clean, by = "Country")%>%
  inner_join(hdi8_clean, by = "Country")

contraceptives_joined <- contraceptive_prevalence_clean %>%
  inner_join(adolescent_births_clean, by = "Country")
```

```{r style-slides, echo = FALSE}
style_xaringan(
  title_slide_background_image = "img/watercolour_sys02_img34_teacup-ocean.jpg"
)
```

class: inverse, middle, center

# Using xaringan

---

## xaringan

- The presentation is created using the `xaringan` package

- Use `---` to separate slides and `--` for incremental builds

--

- Like this

---

## Layouts

You can use plain text

- or bullet points

.pull-left[
or text in two columns $^*$
]
.pull-right[
- like
- this
]

.footnote[
[*] And add footnotes
]

---

## Code

```{r boring-regression}
# a boring regression
model <- lm(dist ~ speed, data = cars)
tidy(model)
glance(model)
```

---

## Plots

```{r recode-species, echo = FALSE}
# In this chunk I'm doing a bunch of analysis that I don't want to present 
# in my slides. But I need the resulting data frame for a plot I want to present.
penguins_modified <- penguins %>%
  mutate(species = fct_other(species, keep = "Adelie"))
```

```{r plot-penguins, echo = FALSE, warning = FALSE, fig.alt = "Body mass vs. flipper lenght of Palmer Penguins for species Adelie and all the others combined together. There is a relatively strong, positive relationship between the two variables. The Adelie penguins are clustered together but they don't exhibit a different trend than the rest of the penguins."}
# Code hidden with echo = FALSE
# Uses modified penguins dataset from previous chunk
# Play around with height and width until you're happy with the look
ggplot(penguins_modified, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +
  geom_point() + 
  theme_minimal()
```

---

## Plot and text

.pull-left[
- Some text
- goes here
]
.pull-right[
```{r warning=FALSE, out.width="100%", fig.width=4, echo=FALSE}
# see how I changed out.width and fig.width from defaults
# to make the figure bigger
ggplot(penguins, aes(x = bill_length_mm, y = species, color = species)) +
  geom_boxplot() +
  theme_minimal()
```
]

---

class: inverse, middle, center

# A new section...

---

## Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r penguins-table, echo = FALSE}
kable(head(penguins), format = "html")
```

---

## Images

```{r castle, echo = FALSE, out.width = "40%", fig.align = "center", fig.cap = "Image credit: Danielle Navarro, Percolate."}
include_graphics("img/watercolour_sys02_img32_percolate.jpg")
```

Or you can also include a full page image. See next slide.

---

background-image: url(img/watercolour_sys02_img32_percolate.jpg)

---

## Math Expressions

You can write LaTeX math expressions inside a pair of dollar signs, e.g. &#36;\alpha+\beta$ renders $\alpha+\beta$. You can use the display style with double dollar signs:

```
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$

Limitations:

1. The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

1. There should not be spaces after the opening `$` or before the closing `$`.

1. Math does not work on the title slide (see [#61](https://github.com/yihui/xaringan/issues/61) for a workaround).

---

class: inverse, middle, center

# Wrap up

---

## Feeling adventurous?

- Want to find out more about `xaringan`? See https://slides.yihui.name/xaringan/#1.

- You are welcomed to use the default styling of the slides. In fact, that's what I expect the majority of you will do. You will differentiate yourself with the content of your presentation.

- But some of you might want to play around with slide styling. The 
`xaringanthemer` provides some solutions for this that: https://pkg.garrickadenbuie.com/xaringanthemer.

- And if you want more bells and whistles, there is also `xaringanExtra`: https://pkg.garrickadenbuie.com/xaringanExtra.

---
```{r 1}

```

---
```{r 2}

```
---
```{r 3}

```
---
```{r 4}
country_joined %>%
  ggplot(aes(x = as.numeric(`Adolescent Birth Rate`))) +
  geom_boxplot() +
  labs(title= "Adolescent Birth Rates Worldwide", subtitle = "Collected in 2019",
       x= "Adolescent Birth Rate (per 1,000 Women Aged 15-19)")
```

- Middle 50% of countries has 13.4 to 72.9 teen birth per 1,000 teen women
- Right-skewed distribution can allow us to compare indicators on both sides of the spectrum.


---
```{r 5}

```
---
```{r 6}

```
---
```{r 7}

```
---
```{r 8}

```
---
```{r 9}

```
---
```{r 10}

```
---
```{r 11}

```
---
```{r 12}
ggplot(data = cat_new) +
  geom_point(aes(x = as.numeric(`Gender Inequality Index`), y = as.numeric(`Adolescent Birth Rate`), color = HDI_cat)) +
  labs(title = "Gender Inequality Index vs Adolescent Birth Rate",
       subtitle = "per 1,000 Live Births",
         x = "Gender Inequality Index", 
       y = "Adolescent Birth Rate",
       color = "HDI Development Category")
```

- Wealthier countries tend to have lower gender equality disparities and lower rates of teen births, and vice versa
- We will get the most out of the intervention by targeting wealth and gender inequality to improve adolescent birth rates in low HDI counties 

---
# References
---
title: "The Indicators That Affect Teen Pregnancy"
subtitle: "and future implications"
author: "Team-No-Name-Yet <br> Isabel Siebrecht, Franklin Feng, & Kaylin Hernandez"
institute: "Duke University"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
# Remove any packages from this list that you're not using
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)

knitr::opts_chunk$set(eval = TRUE, echo = FALSE, message = FALSE, warning = FALSE)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618, 
  out.width = "70%"
  )
```

```{r load-data, include=FALSE}
hdi1 <- read.csv("../data/HDI_Table1.csv")
hdi4 <- read.csv("../data/HDI_Table4.csv")
hdi5 <- read.csv("../data/HDI_Table5.csv")
hdi8 <- read.csv("../data/HDI_Table8.csv")
hdi10 <- read.csv("../data/HDI_Table10.csv")
adolescent_births <- read.csv("../data/Adolescent_Births.csv")
contraceptive_prevalence <- read.csv("../data/Contraceptive_Prevalence.csv")
```

```{r clean-data, echo=FALSE, message=FALSE, warning=FALSE}
hdi1_clean <- slice(hdi1, -c(1:7, 74, 128, 166, 200, 207:270))
hdi1_clean <- select(hdi1_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11))
names(hdi1_clean) <- c("HDI Rank", "Country", "HDI 2019", "Life Expectancy Birth", "Expected Years Schooling", "Mean Years Schooling", "GNI Per Capita", "GNI Per Capita Minus HDI", "HDI 2018")

hdi4_clean <- slice(hdi4, -c(1:7, 74, 128, 166, 200, 207:264))
hdi4_clean <- select(hdi4_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17, X.19, X.21, X.23))
names(hdi4_clean) <- c("HDI Rank", "Country", "Gender Development Index", "Gender Development Index Group", "HDI Female", "HDI Male", "Life Expectancy Birth Female", "Life Expectancy Birth Male", "Expected Years Schooling Female", "Expected Years Schooling Male", "Mean Years Schooling Female", "Mean Years Schooling Male", "Estimated GNI per Capita Female", "Estimated GNI per Capita Male")

hdi5_clean <- slice(hdi5, -c(1:7, 74, 128, 166, 200, 207:270))
hdi5_clean <- select(hdi5_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17))
names(hdi5_clean) <- c("HDI Rank", "Country", "Gender Inequality Index", "Gender Inequality Index Rank", "Maternal Mortality Ratio", "Adolescent Birth Rate", "Seats Parliament Female", "Secondary Education Female", "Secondary Education Male", "Labour Participation Female", "Labour Participation Male")

hdi8_clean <- slice(hdi8, -c(1:7, 74, 128, 166, 200, 207:264))
hdi8_clean <- select(hdi8_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17, X.19, X.21, X.23, X.25, X.27, X.29 : X.33))
names(hdi8_clean) <- c("HDI Rank", "Country", "Infants Breastfed", "Lack DTP Immunization", "Lack Measles Immunization", "Child Malnutrition", "Mortality Rate Infant", "Mortality Rate Under 5", "Mortality Rate Female", "Mortality Rate Male", "Mortality Rate Noncommunicable Female", "Mortality Rate Noncommunicable Male", "Malaria Incidence", "TB Incidence", "HIV Prevalence", "Healthy Life Expectancy at Birth", "Health Expenditure of GDP")

hdi10_clean <- slice(hdi10, -c(1:7, 74, 128, 166, 200, 207:260))
hdi10_clean <- select(hdi10_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17, X.19, X.21, X.23))
names(hdi10_clean) <- c("HDI Rank", "Country", "GDP", "GDP per Capita", "GDP Annual Growth", "Labour Share", "Gross Fixed Capital Formation of GDP", "General Government Consumption of GDP", "General Government Consumption Annual Growth", "Total Tax Revenue of GDP", "Taxes Income Profits Capital Gains of TTR", "External Debt Stock of GNI", "Total Debt Service of GNI", "Consumer Price Index")

adolescent_births_clean <- select(adolescent_births, select = c(ParentLocation, Location, Period, IsLatestYear, FactValueNumeric, Value))
names(adolescent_births_clean) <- c("World Region", "Country", "Period", "Is Latest Year", "Adolescent Births", "Adolescent Births Text")

contraceptive_prevalence_clean <- slice(contraceptive_prevalence, -c(1:8))
contraceptive_prevalence_clean <- select(contraceptive_prevalence_clean, select = c(X, X.2, X.3, X.4, X.5, X.6, X.19))
names(contraceptive_prevalence_clean) <- c("Country", "Survey Start Year", "Survey End Year", "Age Group", "Contraceptive Any Method", "Contraceptive Modern Method", "Contraceptive Traditional Method")
```

```{r join-datasets, echo=FALSE, message=FALSE, warning=FALSE}

country_joined <- hdi1_clean %>%
  inner_join(hdi10_clean, by = "Country")%>%
  inner_join(hdi4_clean, by = "Country")%>%
  inner_join(hdi5_clean, by = "Country")%>%
  inner_join(hdi8_clean, by = "Country")

contraceptives_joined <- contraceptive_prevalence_clean %>%
  inner_join(adolescent_births_clean, by = "Country")
```

```{r style-slides, echo = FALSE}
style_xaringan(
  title_slide_background_image = "img/watercolour_sys02_img34_teacup-ocean.jpg"
)
```

class: inverse, middle, center

# Using xaringan

---

## xaringan

- The presentation is created using the `xaringan` package

- Use `---` to separate slides and `--` for incremental builds

--

- Like this

---

## Layouts

You can use plain text

- or bullet points

.pull-left[
or text in two columns $^*$
]
.pull-right[
- like
- this
]

.footnote[
[*] And add footnotes
]

---

## Code

```{r boring-regression}
# a boring regression
model <- lm(dist ~ speed, data = cars)
tidy(model)
glance(model)
```

---

## Plots

```{r recode-species, echo = FALSE}
# In this chunk I'm doing a bunch of analysis that I don't want to present 
# in my slides. But I need the resulting data frame for a plot I want to present.
penguins_modified <- penguins %>%
  mutate(species = fct_other(species, keep = "Adelie"))
```

```{r plot-penguins, echo = FALSE, warning = FALSE, fig.alt = "Body mass vs. flipper lenght of Palmer Penguins for species Adelie and all the others combined together. There is a relatively strong, positive relationship between the two variables. The Adelie penguins are clustered together but they don't exhibit a different trend than the rest of the penguins."}
# Code hidden with echo = FALSE
# Uses modified penguins dataset from previous chunk
# Play around with height and width until you're happy with the look
ggplot(penguins_modified, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +
  geom_point() + 
  theme_minimal()
```

---

## Plot and text

.pull-left[
- Some text
- goes here
]
.pull-right[
```{r warning=FALSE, out.width="100%", fig.width=4, echo=FALSE}
# see how I changed out.width and fig.width from defaults
# to make the figure bigger
ggplot(penguins, aes(x = bill_length_mm, y = species, color = species)) +
  geom_boxplot() +
  theme_minimal()
```
]

---

class: inverse, middle, center

# A new section...

---

## Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r penguins-table, echo = FALSE}
kable(head(penguins), format = "html")
```

---

## Images

```{r castle, echo = FALSE, out.width = "40%", fig.align = "center", fig.cap = "Image credit: Danielle Navarro, Percolate."}
include_graphics("img/watercolour_sys02_img32_percolate.jpg")
```

Or you can also include a full page image. See next slide.

---

background-image: url(img/watercolour_sys02_img32_percolate.jpg)

---

## Math Expressions

You can write LaTeX math expressions inside a pair of dollar signs, e.g. &#36;\alpha+\beta$ renders $\alpha+\beta$. You can use the display style with double dollar signs:

```
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$

Limitations:

1. The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

1. There should not be spaces after the opening `$` or before the closing `$`.

1. Math does not work on the title slide (see [#61](https://github.com/yihui/xaringan/issues/61) for a workaround).

---

class: inverse, middle, center

# Wrap up

---

## Feeling adventurous?

- Want to find out more about `xaringan`? See https://slides.yihui.name/xaringan/#1.

- You are welcomed to use the default styling of the slides. In fact, that's what I expect the majority of you will do. You will differentiate yourself with the content of your presentation.

- But some of you might want to play around with slide styling. The 
`xaringanthemer` provides some solutions for this that: https://pkg.garrickadenbuie.com/xaringanthemer.

- And if you want more bells and whistles, there is also `xaringanExtra`: https://pkg.garrickadenbuie.com/xaringanExtra.

---
## Overview
- In this project, we chose to research what factors in our world influence the rate of teenage pregnancies.  
  
  
- Premature pregnancies have been found to: 
  - reduce economic contributions,  
  - increase dependency on costly public programs, &   
  - predict a country’s development and prosperity.*  
  
--
  
**Research question:**  
How does a country’s quality of life, measured by human and economic resources, correlate to the birth rates for teenagers aged 15 to 19 years old?  
  
--
The main explanatory variables we chose are:Maternal mortality ratio, Female educational attainment, GDP annual growth rate, Life expectancy at birth, HDI index, Labor force participation rate, and Gender inequality index.

--
  
DISCLAIMER: Western assumptions may have biased our report and analysis
  
[*] National Research Council (US) Panel on Adolescent Pregnancy and Childbearing
  
---
# Intro to Data
---
# Overview of adolescent birth rate
```{r 4-overview, echo=FALSE}
country_joined %>%
  ggplot(aes(x = as.numeric(`Adolescent Birth Rate`))) +
  geom_boxplot() +
  labs(title= "Adolescent Birth Rates Worldwide", subtitle = "Collected in 2019",
       x= "Adolescent Birth Rate (per 1,000 Women Aged 15-19)")
```
- Middle 50% of countries has 13.4 to 72.9 teen birth per 1,000 teen women
- Right-skewed
---
# Maternal Mortality & Teen Birth Rate
```{r maternal-mortality, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}
mortalities <- country_joined %>%
  mutate(Maternal_Mortality_Adj = as.numeric(`Maternal Mortality Ratio`) / 100) %>%
  filter(!is.na(Maternal_Mortality_Adj))

ggplot(mortalities, aes(x = Maternal_Mortality_Adj, 
                           y = as.numeric(`Adolescent Birth Rate`), color = as.numeric(`Mortality Rate Infant`))) +
  geom_point(alpha = 0.6) +
  labs(title= "Does Maternal Mortality Ratio Affect Adolescent Birth Rate?", 
       subtitle = "Per 1,000 Live Births",
       x = "Maternal Mortality Ratio", y = "Adolescent Birth Rate", color = "Infant Mortality Rate")
```

```{r cor-maternal-mortality, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}

cor(as.numeric(country_joined$`Maternal Mortality Ratio`), 
    as.numeric(country_joined$`Adolescent Birth Rate`), method = "pearson", 
    use = "complete.obs")

```

---
# Female Education Attainment & Birth Rate
```{r fem-education dataframe, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}
fem_education <- country_joined %>%
  select(`Adolescent Birth Rate`, `Mean Years Schooling Female`, `Mean Years Schooling Male`, `Secondary Education Female`, `Secondary Education Male`) %>%
  filter(!`Adolescent Birth Rate` == "..") %>%
  filter(!`Mean Years Schooling Female` == "..") %>%
  filter(!`Secondary Education Female` == "..") %>%
  mutate(Adolescent_Birth_Rate = as.numeric(`Adolescent Birth Rate`)) %>%
  mutate(Mean_Years_Schooling_Female = as.numeric(`Mean Years Schooling Female`)) %>%
  mutate(Mean_Years_Schooling_Male = as.numeric(`Mean Years Schooling Male`)) %>%
  mutate(Secondary_Education_Female = as.numeric(`Secondary Education Female`)) %>%
  mutate(Secondary_Education_Male = as.numeric(`Secondary Education Male`))
```

```{r fem-education plot, fig.height=3, fig.width=7, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}
ggplot(data = fem_education, mapping = aes(x= Mean_Years_Schooling_Female, y= Adolescent_Birth_Rate)) +
  geom_point(fill = "Skyblue") +
  geom_smooth() +
  labs(
    title= "Does Female Educational Attainment Affect Adolescent Birth Rate?",
    subtitle = "Per 1,000 Live Births",
    x="Mean Years Schooling for Women",
    y="Adolescent Birth Rate"
  )
```

```{r cor-female-schooling, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}

cor(as.numeric(country_joined$`Mean Years Schooling Female`), 
    as.numeric(country_joined$`Adolescent Birth Rate`), method = "pearson", use="complete.obs")
```
  
---
# GDP Annual Rate & Teen Birth Rate

```{r 7}

```

---
# Life Expectancy & Teen Birth Rate
```{r life-exp, fig.height=3, fig.width=7, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}
ggplot(country_joined, aes(x = as.numeric(`Life Expectancy Birth`), 
                           y = as.numeric(`Adolescent Birth Rate`), color = as.numeric(`Health Expenditure of GDP`))) +
  geom_point(alpha=0.8)+
  labs(
    title= "Does Life Expectancy at Birth Affect Adolescent Birth Rate?",
    subtitle = "Mean Expected Years for a Given Country",
    x="Life Expectancy at Birth",
    y="Adolescent Birth Rate", color = "Health Expenditure of GDP"
  )

```

```{r cor-life-exp, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}

cor(as.numeric(country_joined$`Life Expectancy Birth`), 
    as.numeric(country_joined$`Adolescent Birth Rate`), method = "pearson", use="complete.obs")

```

---

# HDI & Teen Birth Rate
```{r 9-HDI}
ggplot(country_joined, aes(x = as.numeric(`HDI 2019`), 
                           y = as.numeric(`Adolescent Birth Rate`))) +
  geom_point(alpha=0.8)+
  labs(
    title= "Is 2019 HDI Related to Adolescent birth rate?",
    x="2019 HDI",
    y="Adolescent Birth Rate"
  )
```

```{r cor-HDI-2019, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}

cor(as.numeric(country_joined$`HDI 2019`), 
    as.numeric(country_joined$`Adolescent Birth Rate`), method = "pearson", use="complete.obs")

```

---
# Female Labor Participate & Birth Rate
```{r 10-labor, echo=FALSE}
country_joined %>%
  ggplot(aes(x= as.numeric(`Labour Participation Female`), 
             y= as.numeric(`Adolescent Birth Rate`)))+
  geom_point(alpha=0.5) +
  labs(
    title= "Does Female Labor Participation Affect Adolescent Birth Rate?",
    x="Female Labor Participation",
    y="Adolescent Birth Rate"
  )
```

```{r cor-labor-participation, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}

cor(as.numeric(country_joined$`Labour Participation Female`), 
    as.numeric(country_joined$`Adolescent Birth Rate`), method = "pearson", use="complete.obs")
```

---
# Gender Inequality Index & Birth Rate
```{r gender-inequality, fig.height=3, fig.width=7, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}
country_joined %>%
  ggplot(aes(x= as.numeric(`Gender Inequality Index`), 
             y= as.numeric(`Adolescent Birth Rate`))) +
  geom_point(alpha=0.6) +
  labs(
    title= "Is Gender Development Index Related to Adolescent Birth Rate?",
    x="Gender Development Index",
    y="Adolescent Birth Rate"
  )
```

```{r cor-GDI, warning=FALSE, error=FALSE, message=FALSE, echo=FALSE}

cor(as.numeric(country_joined$`Gender Inequality Index`), 
    as.numeric(country_joined$`Adolescent Birth Rate`), method = "pearson", use="complete.obs")

```

---
# Regression
---
# GII & Future Implications
```{r HDI Grouping, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
cat_new <- country_joined %>%
  mutate(HDI_final = as.numeric(`HDI Rank.x`)) %>%
  mutate(HDI_cat = cut(
    HDI_final,
    breaks = c(-Inf, 66, 119, 156, 189, Inf),
    labels = c(
      "Very High", "High", "Medium", "Low", "Other")))
```

```{r 12}
ggplot(data = cat_new) +
  geom_point(aes(x = as.numeric(`Gender Inequality Index`), y = as.numeric(`Adolescent Birth Rate`), color = HDI_cat)) +
  labs(title = "Gender Inequality Index vs Adolescent Birth Rate",
       subtitle = "per 1,000 Live Births",
         x = "Gender Inequality Index", 
       y = "Adolescent Birth Rate",
       color = "HDI Development Category")
```

- Wealthier countries tend to have lower gender equality disparities and lower rates of teen births, and vice versa
- We will get the most out of the intervention by targeting wealth and gender inequality to improve adolescent birth rates in low HDI counties 

---
# References
- National Research Council (US) Panel on Adolescent Pregnancy and Childbearing; Hofferth SL, Hayes CD, editors. Risking the Future: Adolescent Sexuality, Pregnancy, and Childbearing, Volume II: Working Papers and Statistical Appendices. Washington (DC): National Academies Press (US); 1987. CHAPTER 6, SOCIAL AND ECONOMIC CONSEQUENCES OF TEENAGE CHILDBEARING. Available from: https://www.ncbi.nlm.nih.gov/books/NBK219229/  
  
- Youth.gov. (n.d.). Risk and Protective Factors. Youth.gov. Retrieved November 2021, from https://youth.gov/youth-topics/pregnancy-prevention/risk-and-protective-factors. 
  
- Child Trends Databank. (2015). Fertility and birth rates. Available at: http://www.childtrends.org/?indicators=fertility-and-birth-rates - See more at: http://www.childtrends.org/?indicators=fertility-and-birth-rates#sthash.cwLt7kU4.dpuf
  
- Amadeo, K. (2021, November 11). US Real GDP Growth Rate by Year Compared to Inflation and Unemployment. The Balance. Retrieved November 2021, from https://www.thebalance.com/u-s-gdp-growth-3306008. 
  
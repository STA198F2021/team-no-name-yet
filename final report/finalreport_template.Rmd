---
title: "Final Report"
author: "Isabel Siebrecht, Franklin Feng, & Kaylin Hernandez"
date: "11/16/21"
output:
  html_document:
    df_print: paged
subtitle: 'due November 16, 2021 by 11:59 PM '
bibliography: references.bib
link-citations: TRUE
---

# Load Packages

```{r load-packages, error=FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(tidyr)
library(readr)
library(infer)
library(tidymodels)

knitr::opts_chunk$set(eval = TRUE, echo = FALSE, message = FALSE, warning = FALSE)
``` 

# Load Data
```{r load-data, error=FALSE, message=FALSE, warning=FALSE, echo=FALSE}
hdi1 <- read.csv("../data/HDI_Table1.csv")
hdi4 <- read.csv("../data/HDI_Table4.csv")
hdi5 <- read.csv("../data/HDI_Table5.csv")
hdi8 <- read.csv("../data/HDI_Table8.csv")
hdi10 <- read.csv("../data/HDI_Table10.csv")
adolescent_births <- read.csv("../data/Adolescent_Births.csv")
contraceptive_prevalence <- read.csv("../data/Contraceptive_Prevalence.csv")
```

Clean Datasets:
```{r clean-data, error=FALSE, message=FALSE, warning=FALSE, echo=FALSE}
hdi1_clean <- slice(hdi1, -c(1:7, 74, 128, 166, 200, 207:270))
hdi1_clean <- select(hdi1_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11))
names(hdi1_clean) <- c("HDI Rank", "Country", "HDI 2019", "Life Expectancy Birth", "Expected Years Schooling", "Mean Years Schooling", "GNI Per Capita", "GNI Per Capita Minus HDI", "HDI 2018")

hdi4_clean <- slice(hdi4, -c(1:7, 74, 128, 166, 200, 207:264))
hdi4_clean <- select(hdi4_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17, X.19, X.21, X.23))
names(hdi4_clean) <- c("HDI Rank", "Country", "Gender Development Index", "Gender Development Index Group", "HDI Female", "HDI Male", "Life Expectancy Birth Female", "Life Expectancy Birth Male", "Expected Years Schooling Female", "Expected Years Schooling Male", "Mean Years Schooling Female", "Mean Years Schooling Male", "Estimated GNI per Capita Female", "Estimated GNI per Capita Male")

hdi5_clean <- slice(hdi5, -c(1:7, 74, 128, 166, 200, 207:270))
hdi5_clean <- select(hdi5_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17))
names(hdi5_clean) <- c("HDI Rank", "Country", "Gender Inequality Index", "Gender Inequality Index Rank", "Maternal Mortality Ratio", "Adolescent Birth Rate", "Seats Parliament Female", "Secondary Education Female", "Secondary Education Male", "Labour Participation Female", "Labour Participation Male")

hdi8_clean <- slice(hdi8, -c(1:7, 74, 128, 166, 200, 207:264))
hdi8_clean <- select(hdi8_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17, X.19, X.21, X.23, X.25, X.27, X.29 : X.33))
names(hdi8_clean) <- c("HDI Rank", "Country", "Infants Breastfed", "Lack DTP Immunization", "Lack Measles Immunization", "Child Malnutrition", "Mortality Rate Infant", "Mortality Rate Under 5", "Mortality Rate Female", "Mortality Rate Male", "Mortality Rate Noncommunicable Female", "Mortality Rate Noncommunicable Male", "Malaria Incidence", "TB Incidence", "HIV Prevalence", "Healthy Life Expectancy at Birth", "Health Expenditure of GDP")

hdi10_clean <- slice(hdi10, -c(1:7, 74, 128, 166, 200, 207:260))
hdi10_clean <- select(hdi10_clean, select = -c(X.1, X.3, X.5, X.7, X.9, X.11, X.13, X.15, X.17, X.19, X.21, X.23))
names(hdi10_clean) <- c("HDI Rank", "Country", "GDP", "GDP per Capita", "GDP Annual Growth", "Labour Share", "Gross Fixed Capital Formation of GDP", "General Government Consumption of GDP", "General Government Consumption Annual Growth", "Total Tax Revenue of GDP", "Taxes Income Profits Capital Gains of TTR", "External Debt Stock of GNI", "Total Debt Service of GNI", "Consumer Price Index")

adolescent_births_clean <- select(adolescent_births, select = c(ParentLocation, Location, Period, IsLatestYear, FactValueNumeric, Value))
names(adolescent_births_clean) <- c("World Region", "Country", "Period", "Is Latest Year", "Adolescent Births", "Adolescent Births Text")

contraceptive_prevalence_clean <- slice(contraceptive_prevalence, -c(1:8))
contraceptive_prevalence_clean <- select(contraceptive_prevalence_clean, select = c(X, X.2, X.3, X.4, X.5, X.6, X.19))
names(contraceptive_prevalence_clean) <- c("Country", "Survey Start Year", "Survey End Year", "Age Group", "Contraceptive Any Method", "Contraceptive Modern Method", "Contraceptive Traditional Method")
```

Join:
```{r join-datasets, echo=FALSE}

country_joined <- hdi1_clean %>%
  inner_join(hdi10_clean, by = "Country")%>%
  inner_join(hdi4_clean, by = "Country")%>%
  inner_join(hdi5_clean, by = "Country")%>%
  inner_join(hdi8_clean, by = "Country")

contraceptives_joined <- contraceptive_prevalence_clean %>%
  inner_join(adolescent_births_clean, by = "Country")
```

# Introduction
Our group chose to research what influences the rates of teenage pregnancies because we consider premature pregnancies one of the most significant indicators of a country’s development and prosperity. Considering the repercussions of lost economic contributions and increased dependency on costly public programs [https://www.ncbi.nlm.nih.gov/books/NBK219229/], we hope our findings can encourage governments to reduce the rate of teenage pregnancies by focusing on the strongest predictor variables we identify in this report.  

In essence, we attempt to answer how a country’s quality of life, measured by human and economic resources, correlates to the birth rates for teenagers aged 15 to 19 years old. To answer our question, our explanatory variables of adolescent pregnancy rates are female educational attainment, GDP, life expectancy at birth, HDI, labor force participation rate, and gender inequality index.  
Information provided by Youth.gov supports our predictors because they broadly encompass the individual, family, and community that influence teenage pregnancies [https://youth.gov/youth-topics/pregnancy-prevention/risk-and-protective-factors].

We pulled our data on adolescent birth rate from the World Health Organization who collected the results via various national and international surveys and country reports. We also pulled data from the 2020 Human Development Report provided by the United Nations. This data consisted of female educational attainment (number of years of schooling), GDP, life expectancy at birth, HDI, labor force participation rate, and gender inequality index. The gender equality index measures the gender disparity in a country on a scale from 0 to 1. The greater the value, the greater the measure of inequality.  

As a disclaimer, we acknowledge that our findings are based on preconceived, Western assumptions of what qualifies as a global indicator of “status.” Thus, we conducted this report on our assumptions of what defines a country’s prosperity and development.  

# Methodology

## Intro to data
For context purposes, we found data on 195 countries, and this is what the density plot for adolescent birth rate in our sample looks like. Additionally, throughout the report, adolescent birth rate is measured as the number of births per 1000 women aged 15-19 years old in a given population.
```{r total-rate, warning=FALSE, message=FALSE, error=FALSE, echo=FALSE, fig.height=3, fig.width=7}
hdi_joined %>%
  ggplot(aes(x= as.numeric(`Adolescent Birth Rate`))) +
  geom_boxplot() +
  labs(title= "International Adolsecent Birth Rates, 2019",
       x= "Adolescent Birth Rate (per 1,000 women aged 15-19)")

```
From this, we see that the middle 50% of countries have a teenage birth rate between 39.1 and 70.5. Considering a high birth rate is 40-50 births per 1,000 women, our boxplot shows a distribution of relatively high rates. We also have a few outliers, which are Chad (161.1), Mali (169.1), and Niger (186.5). All three have HDI ranks 187, 184, and 189, respectively.
```{r quantile, error=FALSE, message=FALSE, warning=FALSE, echo=FALSE}
quantile(as.numeric(country_joined$`Adolescent Birth Rate`), c(0, 0.25, 0.50, 0.75, 1))
```

## fig3
**Is maternal mortality ratio related to adolescent birth rate?**
```{r maternal-mortality, error=FALSE, warning=FALSE, message=FALSE, fig.height=3, fig.width=7}
ggplot(country_joined, aes(x = as.numeric(`Maternal Mortality Ratio`), 
                           y = as.numeric(`Adolescent Birth Rate`))) +
  geom_point() +
  labs(title= "Is Maternal Mortality Ratio Related to Adolescent Birth Rate",
       x = "Maternal Mortality Ratio", y = "Adolescent Birth Rate")

```

This data shows a positive trend, as maternal mortality increases, so too does
adolescent birth rate across countries in 2019.

**Is female educational attainment related to adolescent birth rate?**
## fig4
```{r fem-education, error=FALSE, warning=FALSE, message=FALSE, fig.height=3, fig.width=7}
country_joined %>%
  ggplot(aes(x= as.numeric(`Expected Years Schooling Female`), 
             y= as.numeric(`Adolescent Birth Rate`))) +
  geom_point() +
  labs(
    title= "Is Female Educational Attainment Related to Adolescent Birth Rate?",
    x="Expected Years Schooling for Women",
    y="Adolescent Birth Rate"
  )
```
This graph highlights a trend that with more average years of schooling for women,
there is a lower rate of adolescent births. 

**Is GDP related to adolescent birth rate?**
## fig5
```{r GDP, error=FALSE, warning=FALSE, message=FALSE, fig.height=3, fig.width=7}
ggplot(country_joined, aes(x = as.numeric(`GDP`), 
                           y = as.numeric(`Adolescent Birth Rate`), color = as.numeric(`HDI Rank.x`))) +
  geom_point() +
  geom_smooth() +
  labs(
    title= "Is GDP Related to Adolescent Birth Rates?",
    x="GDP Level",
    y="Adolescent Birth Rate",
    color = "HDI Rank") 
```

```{r GDP-linreg}
country_joined <- country_joined %>%
  filter(!`GDP` == "..") %>%
  filter(!`Adolescent Birth Rate` == "..") %>%
  #filter(!`GNI Per Capita` == "..") %>%
  filter(!`GDP per Capita` == "..") %>%
  mutate(GDP = as.numeric(`GDP`)) %>%
  mutate(Adolescent_Birth_Rate = as.numeric(`Adolescent Birth Rate`)) %>%
  mutate(HDI_Rank = as.factor(`HDI Rank.x`)) %>%
  #mutate(GNI_Per_Capita = as.numeric(`GNI per Capita`)) %>%
  mutate(`GDP per Capita` = str_replace(`GDP per Capita`, ",", "")) %>%
  mutate(GDP_Per_Capita = as.numeric(`GDP per Capita`))
  

gdp_linreg <- country_joined %>%
  select(Adolescent_Birth_Rate, GDP, HDI_Rank, GDP_Per_Capita)
         
mainfit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(Adolescent_Birth_Rate ~ GDP + HDI_Rank + GDP_Per_Capita, data = gdp_linreg)
tidy(mainfit)
```


**Is life expectancy at birth related to adolescent birth rate?**
#fig6
```{r life-exp, error=FALSE, warning=FALSE, message=FALSE, fig.height=3, fig.width=7}
ggplot(country_joined, aes(x = as.numeric(`Life Expectancy Birth Female`), 
                           y = as.numeric(`Adolescent Birth Rate`))) +
  geom_point()+
  labs(
    title= "Is Female Life Expectacy at Birth Related to Adolescent Birth Rate?",
    x="Female Life Expectacy at Birth",
    y="Adolescent Birth Rate"
  )

```


**Is HDI in 2019 related to adolescent birth rate?**
## fig7
```{r HDI, error=FALSE, warning=FALSE, message=FALSE, fig.height=3, fig.width=7}
country_joined %>%
  ggplot(aes(x= as.numeric(`HDI 2019`), 
             y= as.numeric(`Adolescent Birth Rate`))) +
  geom_point() +
  labs(
    title= "Is HDI in 2019 Related to Adolescent Birth Rate?",
    x="2019 HDI",
    y="Adolescent Birth Rate"
  )
```

**Is labor force participation rate related to adolescent birth rate?**
## fig8
```{r labor-force, error=FALSE, warning=FALSE, message=FALSE, fig.height=3, fig.width=7}
country_joined %>%
  ggplot(aes(x= as.numeric(`Labour Participation Female`), 
             y= as.numeric(`Adolescent Birth Rate`)))+
  geom_point() +
  labs(
    title= "Is Female Labor Participation Related to Adolescent Birth Rate?",
    x="Female Labor Participation",
    y="Adolescent Birth Rate"
  )
```

**Is the gender develop index related to adolescent birth rate?**
## fig9

```{r gender-inequality, error=FALSE, warning=FALSE, message=FALSE, fig.height=3, fig.width=7}
country_joined %>%
  ggplot(aes(x= as.numeric(`Gender Development Index.y`), 
             y= as.numeric(`Adolescent Birth Rate`))) +
  geom_point() +
  labs(
    title= "Is Gender Development Index Related to Adolescent Birth Rate?",
    x="Gender Development Index",
    y="Adolescent Birth Rate"
  )
```

As gender development index increases there is also a trending increase in
adolescent birth rate. 

# Linear regression
**Which variable has the strongest correlation to adolescent birth rate?**
```{r}
# mainfit_2 <- linear_reg() %>% 
#   set_engine("lm") %>%
#   fit(`Adolescent Birth Rate` ~ `Gender Development Index.y` + `Labour Participation Female` + `HDI 2019` + `Life Expectancy Birth Female` + `GDP` + `HDI Rank.x` + `Expected Years Schooling Female` + `Maternal Mortality Ratio`, data = country_joined)
# tidy(mainfit_2)
```

```{r}

```

Ho: Β1 = 0, There is no correlation between __ and teenage birthrate. 

Ha: Β1 ≠ 0, There is a correlation between __ and teenage birthrate. 

# Summary & Next Steps

